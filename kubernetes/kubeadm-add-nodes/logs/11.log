+ . ./config.sh
++ export ADDRESS_M1=ubuntu16-k3-master1.kubernetes
++ ADDRESS_M1=ubuntu16-k3-master1.kubernetes
++ export CONTROLLER_LIST=ubuntu16-k3-master1.kubernetes
++ CONTROLLER_LIST=ubuntu16-k3-master1.kubernetes
++ export 'WORKER_LIST=ubuntu16-k3-node1.kubernetes                     ubuntu16-k3-node2.kubernetes                     ubuntu16-k3-node3.kubernetes                     ubuntu16-k5-master1.kubernetes                     ubuntu16-k5-master2.kubernetes                     ubuntu16-k5-master3.kubernetes                     ubuntu16-k5-node1.kubernetes                     ubuntu16-k5-node2.kubernetes                     ubuntu16-k5-node3.kubernetes                     ubuntu16-k6-master1.kubernetes                     ubuntu16-k6-master2.kubernetes                     ubuntu16-k6-master3.kubernetes                     ubuntu16-k6-node1.kubernetes                      ubuntu16-k6-node2.kubernetes                     ubuntu16-k6-node3.kubernetes'
++ WORKER_LIST='ubuntu16-k3-node1.kubernetes                     ubuntu16-k3-node2.kubernetes                     ubuntu16-k3-node3.kubernetes                     ubuntu16-k5-master1.kubernetes                     ubuntu16-k5-master2.kubernetes                     ubuntu16-k5-master3.kubernetes                     ubuntu16-k5-node1.kubernetes                     ubuntu16-k5-node2.kubernetes                     ubuntu16-k5-node3.kubernetes                     ubuntu16-k6-master1.kubernetes                     ubuntu16-k6-master2.kubernetes                     ubuntu16-k6-master3.kubernetes                     ubuntu16-k6-node1.kubernetes                      ubuntu16-k6-node2.kubernetes                     ubuntu16-k6-node3.kubernetes'
++ export 'ETCD_LIST=ubuntu16-k3-node1.kubernetes                   ubuntu16-k3-node2.kubernetes                   ubuntu16-k3-node3.kubernetes '
++ ETCD_LIST='ubuntu16-k3-node1.kubernetes                   ubuntu16-k3-node2.kubernetes                   ubuntu16-k3-node3.kubernetes '
+ export TEST=false
+ TEST=false
+ '[' false = true ']'
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k3-node1.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (52,3 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
 already present
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (52,2 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:4 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
41,2 ko réceptionnés en 0s (96,0 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (28,1 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
gpg: aucune donnée OpenPGP valable n'a été trouvée.
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Ign:7 https://apt.kubernetes.io kubernetes-xenial InRelease
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
14,1 ko réceptionnés en 14s (979 o/s)
Lecture des listes de paquets…
W: Erreur de GPG : https://apt.kubernetes.io kubernetes-xenial InRelease : Les signatures suivantes n'ont pas pu être vérifiées car la clé publique n'est pas disponible : NO_PUBKEY 3746C208A7317B0F
W: The repository 'https://apt.kubernetes.io kubernetes-xenial InRelease' is not signed.
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
ATTENTION : les paquets suivants n'ont pas été authentifiés.
  kubernetes-cni kubelet kubectl kubeadm
E: There were unauthenticated packages and -y was used without --allow-unauthenticated
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k3-node2.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (44,7 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (55,7 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 http://security.ubuntu.com/ubuntu xenial-security InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
41,2 ko réceptionnés en 0s (103 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (21,5 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
14,1 ko réceptionnés en 2s (6 786 o/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 4s (9 591 ko/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k3-node3.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease [102 kB]
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease [102 kB]
Réception de:5 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [623 kB]
Réception de:6 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main i386 Packages [600 kB]
Réception de:7 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main Translation-en [257 kB]
Réception de:8 http://fr.archive.ubuntu.com/ubuntu xenial-updates/restricted amd64 Packages [8 040 B]
Réception de:9 http://fr.archive.ubuntu.com/ubuntu xenial-updates/restricted i386 Packages [8 056 B]
Réception de:10 http://fr.archive.ubuntu.com/ubuntu xenial-updates/restricted Translation-en [2 688 B]
Réception de:11 http://fr.archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [522 kB]
Réception de:12 http://fr.archive.ubuntu.com/ubuntu xenial-updates/universe i386 Packages [503 kB]
Réception de:13 http://fr.archive.ubuntu.com/ubuntu xenial-updates/universe Translation-en [206 kB]
Réception de:14 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages [348 kB]
Réception de:15 http://security.ubuntu.com/ubuntu xenial-security/main i386 Packages [326 kB]
Réception de:16 http://security.ubuntu.com/ubuntu xenial-security/main Translation-en [152 kB]
Réception de:17 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [161 kB]
Réception de:18 http://security.ubuntu.com/ubuntu xenial-security/universe i386 Packages [143 kB]
Réception de:19 http://security.ubuntu.com/ubuntu xenial-security/universe Translation-en [84,6 kB]
Réception de:20 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:21 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 Packages [106 kB]
Réception de:22 http://archive.ubuntu.com/ubuntu xenial-proposed/main i386 Packages [100 kB]
Réception de:23 http://archive.ubuntu.com/ubuntu xenial-proposed/main Translation-en [38,5 kB]
4 750 ko réceptionnés en 5s (903 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 4s (12,6 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
 already present
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 1s (45,2 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://security.ubuntu.com/ubuntu xenial-security InRelease
Atteint:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
41,2 ko réceptionnés en 0s (99,2 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (23,9 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (992 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
gpg: aucune donnée OpenPGP valable n'a été trouvée.
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Ign:7 https://apt.kubernetes.io kubernetes-xenial InRelease
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (178 ko/s)
Lecture des listes de paquets…
W: Erreur de GPG : https://apt.kubernetes.io kubernetes-xenial InRelease : Les signatures suivantes n'ont pas pu être vérifiées car la clé publique n'est pas disponible : NO_PUBKEY 3746C208A7317B0F
W: The repository 'https://apt.kubernetes.io kubernetes-xenial InRelease' is not signed.
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
ATTENTION : les paquets suivants n'ont pas été authentifiés.
  kubernetes-cni kubelet kubectl kubeadm
E: There were unauthenticated packages and -y was used without --allow-unauthenticated
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-master1.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
356 ko réceptionnés en 0s (534 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (40,1 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (62,3 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Réception de:1 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:3 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:6 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:7 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
397 ko réceptionnés en 3s (116 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (29,7 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:5 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:6 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
356 ko réceptionnés en 7s (47,9 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Err:7 https://apt.kubernetes.io kubernetes-xenial InRelease
  Could not resolve host: apt.kubernetes.io
356 ko réceptionnés en 11s (30,9 ko/s)
Lecture des listes de paquets…
W: Impossible de récupérer https://apt.kubernetes.io/dists/kubernetes-xenial/InRelease  Could not resolve host: apt.kubernetes.io
W: Le téléchargement de quelques fichiers d'index a échoué, ils ont été ignorés, ou les anciens ont été utilisés à la place.
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
E: Impossible de trouver le paquet kubelet
E: Impossible de trouver le paquet kubeadm
E: Impossible de trouver le paquet kubectl
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-master2.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
356 ko réceptionnés en 5s (68,4 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (42,8 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (56,7 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (706 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (25,6 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 5s (61,1 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Err:7 https://apt.kubernetes.io kubernetes-xenial InRelease
  Could not resolve host: apt.kubernetes.io
356 ko réceptionnés en 8s (41,7 ko/s)
Lecture des listes de paquets…
W: Impossible de récupérer https://apt.kubernetes.io/dists/kubernetes-xenial/InRelease  Could not resolve host: apt.kubernetes.io
W: Le téléchargement de quelques fichiers d'index a échoué, ils ont été ignorés, ou les anciens ont été utilisés à la place.
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
E: Impossible de trouver le paquet kubelet
E: Impossible de trouver le paquet kubeadm
E: Impossible de trouver le paquet kubectl
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-master3.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
356 ko réceptionnés en 0s (1 013 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 4s (13,4 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
 already present
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 1s (44,7 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (914 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (22,6 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (985 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (162 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 3s (14,1 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-node1.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
356 ko réceptionnés en 0s (593 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (49,7 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 8s (5 914 ko/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
Réception de:7 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
397 ko réceptionnés en 7s (54,4 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (28,7 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (931 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 13s (27,1 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 3s (12,8 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-node2.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
356 ko réceptionnés en 5s (68,2 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (50,4 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (55,0 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (750 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (26,8 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (958 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (180 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 3s (13,2 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k5-node3.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
356 ko réceptionnés en 13s (26,5 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (31,5 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (66,2 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (725 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (23,2 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (867 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (183 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 3s (13,6 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-master1.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Réception de:1 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
356 ko réceptionnés en 8s (44,3 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (31,2 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
 already present
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (61,7 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (890 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (29,9 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (590 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 1s (186 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 2s (20,3 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-master2.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
356 ko réceptionnés en 0s (1 032 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (40,1 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 4s (10,8 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (622 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (23,0 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (781 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (159 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 3s (12,8 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-master3.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
356 ko réceptionnés en 0s (1 014 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (38,4 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
 already present
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (57,3 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:5 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
397 ko réceptionnés en 3s (102 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (29,6 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (601 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 2s (160 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 4s (10,7 Mo/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-node1.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
356 ko réceptionnés en 5s (68,0 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (52,2 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
+zsh:10> echo ' already present'
 already present
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (60,5 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:5 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
Réception de:6 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
397 ko réceptionnés en 8s (47,0 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (27,5 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 3s (93,1 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 17s (21,7 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:2 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
Réception de:5 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:6 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 7s (6 038 ko/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-node2.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
356 ko réceptionnés en 13s (27,1 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 1s (50,5 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (61,9 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (776 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (21,9 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Verifying Checksum
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (995 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 1s (197 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 4s (9 157 ko/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
Sélection du paquet kubeadm précédemment désélectionné.
Préparation du dépaquetage de .../kubeadm_1.7.4-00_amd64.deb ...
Dépaquetage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Paramétrage de ebtables (2.0.10.4-3.4ubuntu2) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Paramétrage de kubernetes-cni (0.5.1-00) ...
Paramétrage de socat (1.7.3.1-1) ...
Paramétrage de kubelet (1.7.4-00) ...
Paramétrage de kubectl (1.7.4-00) ...
Paramétrage de kubeadm (1.7.4-00) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+ for host in '$WORKER_LIST'
++ uname -r
+ ssh root@ubuntu16-k6-node3.kubernetes '

        set -x

        # upgrade system
        apt-get update
        apt-get upgrade -y

        # populate hosts file
        ! grep -q '\''^'\'' /etc/hosts && echo '\''   ubuntu16-k3-master1.kubernetes'\'' >> /etc/hosts || echo '\'' already present'\''

        cat /etc/hosts

        # install docker
        apt-get install -y            linux-image-extra-4.10.0-32-generic            linux-image-extra-virtual

        apt-get install -y            apt-transport-https            ca-certificates            curl            software-properties-common

        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

        add-apt-repository             "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

        apt-get update

        apt-get install -y docker-ce

        docker run hello-world



        # install k8s tools
        apt-get update && apt-get install -y apt-transport-https

        curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -

        add-apt-repository "deb https://apt.kubernetes.io/ kubernetes-xenial main"


        apt-get update
        apt-get install -y kubelet kubeadm kubectl

    '
+zsh:6> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Réception de:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
356 ko réceptionnés en 5s (68,6 ko/s)
Lecture des listes de paquets…
+zsh:7> apt-get upgrade -y
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Calcul de la mise à jour…
Les paquets suivants seront mis à jour :
  grub-legacy-ec2 libgnutls-openssl27 libgnutls30 libmspack0 linux-firmware
  lxd lxd-client python3-update-manager snapd update-manager-core
  update-notifier-common
11 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 55,8 Mo dans les archives.
Après cette opération, 5 297 ko d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 libmspack0 amd64 0.5-1ubuntu0.16.04.1 [37,0 kB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd amd64 2.0.10-0ubuntu1~16.04.2 [3 416 kB]
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 lxd-client amd64 2.0.10-0ubuntu1~16.04.2 [1 857 kB]
Réception de:4 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-manager-core all 1:16.04.9 [5 330 B]
Réception de:5 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 python3-update-manager all 1:16.04.9 [31,9 kB]
Réception de:6 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 update-notifier-common all 3.168.5 [165 kB]
Réception de:7 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls-openssl27 amd64 3.4.10-4ubuntu1.4 [22,0 kB]
Réception de:8 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Réception de:9 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-firmware all 1.157.12 [38,8 MB]
Réception de:10 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 snapd amd64 2.27.3 [10,9 MB]
Réception de:11 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 grub-legacy-ec2 all 0.7.9-233-ge586fe35-0ubuntu1~16.04.1 [28,3 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
55,8 Mo réceptionnés en 4s (11,7 Mo/s)
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96854 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../lxd_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Dépaquetage de lxd (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Warning: Stopping lxd.service, but it can still be activated by:
  lxd.socket
Préparation du dépaquetage de .../lxd-client_2.0.10-0ubuntu1~16.04.2_amd64.deb ...
Dépaquetage de lxd-client (2.0.10-0ubuntu1~16.04.2) sur (2.0.10-0ubuntu1~16.04.1) ...
Préparation du dépaquetage de .../update-manager-core_1%3a16.04.9_all.deb ...
Dépaquetage de update-manager-core (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../python3-update-manager_1%3a16.04.9_all.deb ...
Dépaquetage de python3-update-manager (1:16.04.9) sur (1:16.04.8) ...
Préparation du dépaquetage de .../update-notifier-common_3.168.5_all.deb ...
Dépaquetage de update-notifier-common (3.168.5) sur (3.168.4) ...
Préparation du dépaquetage de .../libgnutls-openssl27_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Dépaquetage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) sur (3.4.10-4ubuntu1.3) ...
Préparation du dépaquetage de .../libmspack0_0.5-1ubuntu0.16.04.1_amd64.deb ...
Dépaquetage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) sur (0.5-1) ...
Préparation du dépaquetage de .../linux-firmware_1.157.12_all.deb ...
Dépaquetage de linux-firmware (1.157.12) sur (1.157.11) ...
Préparation du dépaquetage de .../snapd_2.27.3_amd64.deb ...
Warning: Stopping snapd.service, but it can still be activated by:
  snapd.socket
Dépaquetage de snapd (2.27.3) sur (2.26.10) ...
Préparation du dépaquetage de .../grub-legacy-ec2_0.7.9-233-ge586fe35-0ubuntu1~16.04.1_all.deb ...
Conservation de « détournement de /usr/sbin/grub-set-default en /usr/sbin/grub-set-default.real par grub-legacy-ec2 »
Dépaquetage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) sur (0.7.9-153-g16a7302f-0ubuntu1~16.04.2) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Paramétrage de lxd-client (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de lxd (2.0.10-0ubuntu1~16.04.2) ...
Paramétrage de python3-update-manager (1:16.04.9) ...
Paramétrage de update-manager-core (1:16.04.9) ...
Paramétrage de update-notifier-common (3.168.5) ...
Paramétrage de libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libgnutls-openssl27:amd64 (3.4.10-4ubuntu1.4) ...
Paramétrage de libmspack0:amd64 (0.5-1ubuntu0.16.04.1) ...
Paramétrage de linux-firmware (1.157.12) ...
update-initramfs: Generating /boot/initrd.img-4.4.0-93-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
update-initramfs: Generating /boot/initrd.img-4.4.0-92-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
Paramétrage de snapd (2.27.3) ...
Installation de la nouvelle version du fichier de configuration /etc/apparmor.d/usr.lib.snapd.snap-confine.real ...
Paramétrage de grub-legacy-ec2 (0.7.9-233-ge586fe35-0ubuntu1~16.04.1) ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Searching for GRUB installation directory ... found: /boot/grub
Searching for default file ... found: /boot/grub/default
Testing for an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
Searching for splash image ... none found, skipping ...
Found kernel: /vmlinuz-4.4.0-92-generic
Found kernel: /vmlinuz-4.4.0-93-generic
Found kernel: /vmlinuz-4.4.0-92-generic
Replacing config file /run/grub/menu.lst with new version
Updating /boot/grub/menu.lst ... done

Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
+zsh:10> grep -q '^' /etc/hosts
 already present
+zsh:10> echo ' already present'
+zsh:12> cat /etc/hosts
127.0.0.1	localhost
127.0.1.1	ubuntu-server

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
+zsh:15> apt-get install -y linux-image-extra-4.10.0-32-generic linux-image-extra-virtual
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
The following additional packages will be installed:
  linux-image-4.10.0-32-generic
Paquets suggérés :
  fdutils linux-tools linux-headers-4.10.0-32-generic
Les NOUVEAUX paquets suivants seront installés :
  linux-image-4.10.0-32-generic linux-image-extra-4.10.0-32-generic
  linux-image-extra-virtual
0 mis à jour, 3 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 50,0 Mo dans les archives.
Après cette opération, 226 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [20,2 MB]
Réception de:2 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 linux-image-extra-virtual amd64 4.4.0.93.98 [1 768 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 linux-image-extra-4.10.0-32-generic amd64 4.10.0-32.36~16.04.1 [29,8 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
50,0 Mo réceptionnés en 0s (66,1 Mo/s)
Sélection du paquet linux-image-4.10.0-32-generic précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 96861 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../linux-image-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
Done.
Dépaquetage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-4.10.0-32-generic précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-4.10.0-32-generic_4.10.0-32.36~16.04.1_amd64.deb ...
Dépaquetage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Sélection du paquet linux-image-extra-virtual précédemment désélectionné.
Préparation du dépaquetage de .../linux-image-extra-virtual_4.4.0.93.98_amd64.deb ...
Dépaquetage de linux-image-extra-virtual (4.4.0.93.98) ...
Paramétrage de linux-image-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-4.10.0-32-generic (4.10.0-32.36~16.04.1) ...
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
update-initramfs: Generating /boot/initrd.img-4.10.0-32-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.10.0-32-generic /boot/vmlinuz-4.10.0-32-generic
Création du fichier de configuration GRUB…
Image Linux trouvée : /boot/vmlinuz-4.10.0-32-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.10.0-32-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-93-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-93-generic
Image Linux trouvée : /boot/vmlinuz-4.4.0-92-generic
Image mémoire initiale trouvée : /boot/initrd.img-4.4.0-92-generic
fait
Paramétrage de linux-image-extra-virtual (4.4.0.93.98) ...
+zsh:17> apt-get install -y apt-transport-https ca-certificates curl software-properties-common
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
ca-certificates is already the newest version (20160104ubuntu1).
apt-transport-https is already the newest version (1.2.24).
curl is already the newest version (7.47.0-1ubuntu2.2).
software-properties-common is already the newest version (0.96.20.7).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:19> curl -fsSL https://download.docker.com/linux/ubuntu/gpg
+zsh:19> apt-key add -
OK
+zsh:21> lsb_release -cs
+zsh:21> add-apt-repository 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
+zsh:23> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Réception de:4 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:5 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:6 https://download.docker.com/linux/ubuntu xenial InRelease [38,9 kB]
Réception de:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [2 346 B]
397 ko réceptionnés en 0s (928 ko/s)
Lecture des listes de paquets…
+zsh:25> apt-get install -y docker-ce
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7
Paquets suggérés :
  mountall
Les NOUVEAUX paquets suivants seront installés :
  aufs-tools cgroupfs-mount docker-ce libltdl7
0 mis à jour, 4 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 20,3 Mo dans les archives.
Après cette opération, 96,7 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92,9 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4 970 B]
Réception de:3 http://fr.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38,3 kB]
Réception de:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 17.06.1~ce-0~ubuntu [20,2 MB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
20,3 Mo réceptionnés en 0s (27,6 Mo/s)
Sélection du paquet aufs-tools précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 102882 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Dépaquetage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Sélection du paquet cgroupfs-mount précédemment désélectionné.
Préparation du dépaquetage de .../cgroupfs-mount_1.2_all.deb ...
Dépaquetage de cgroupfs-mount (1.2) ...
Sélection du paquet libltdl7:amd64 précédemment désélectionné.
Préparation du dépaquetage de .../libltdl7_2.4.6-0.1_amd64.deb ...
Dépaquetage de libltdl7:amd64 (2.4.6-0.1) ...
Sélection du paquet docker-ce précédemment désélectionné.
Préparation du dépaquetage de .../docker-ce_17.06.1~ce-0~ubuntu_amd64.deb ...
Dépaquetage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour man-db (2.7.5-1) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Paramétrage de aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Paramétrage de cgroupfs-mount (1.2) ...
Paramétrage de libltdl7:amd64 (2.4.6-0.1) ...
Paramétrage de docker-ce (17.06.1~ce-0~ubuntu) ...
Traitement des actions différées (« triggers ») pour libc-bin (2.23-0ubuntu9) ...
Traitement des actions différées (« triggers ») pour systemd (229-4ubuntu19) ...
Traitement des actions différées (« triggers ») pour ureadahead (0.100.0-19) ...
+zsh:27> docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b04784fba78d: Pulling fs layer
b04784fba78d: Download complete
b04784fba78d: Pull complete
Digest: sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://cloud.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/

+zsh:32> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
356 ko réceptionnés en 0s (618 ko/s)
Lecture des listes de paquets…
+zsh:32> apt-get install -y apt-transport-https
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
apt-transport-https is already the newest version (1.2.24).
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
0 mis à jour, 0 nouvellement installés, 0 à enlever et 0 non mis à jour.
+zsh:34> curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg
+zsh:34> apt-key add -
OK
+zsh:36> add-apt-repository 'deb https://apt.kubernetes.io/ kubernetes-xenial main'
+zsh:39> apt-get update
Atteint:1 http://fr.archive.ubuntu.com/ubuntu xenial InRelease
Atteint:2 http://fr.archive.ubuntu.com/ubuntu xenial-updates InRelease
Réception de:3 http://archive.ubuntu.com/ubuntu xenial-proposed InRelease [253 kB]
Atteint:4 http://fr.archive.ubuntu.com/ubuntu xenial-backports InRelease
Réception de:5 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Atteint:6 https://download.docker.com/linux/ubuntu xenial InRelease
Réception de:7 https://apt.kubernetes.io kubernetes-xenial InRelease [161 B]
Réception de:8 https://apt.kubernetes.io kubernetes-xenial/main amd64 Packages [5 170 B]
370 ko réceptionnés en 1s (193 ko/s)
Lecture des listes de paquets…
+zsh:40> apt-get install -y kubelet kubeadm kubectl
Lecture des listes de paquets…
Construction de l'arbre des dépendances…
Lecture des informations d'état…
Les paquets suivants ont été installés automatiquement et ne sont plus nécessaires :
  linux-headers-4.4.0-92 linux-headers-4.4.0-92-generic
  linux-image-4.4.0-92-generic linux-image-extra-4.4.0-92-generic
Veuillez utiliser « apt autoremove » pour les supprimer.
The following additional packages will be installed:
  ebtables kubernetes-cni socat
Les NOUVEAUX paquets suivants seront installés :
  ebtables kubeadm kubectl kubelet kubernetes-cni socat
0 mis à jour, 6 nouvellement installés, 0 à enlever et 0 non mis à jour.
Il est nécessaire de prendre 45,4 Mo dans les archives.
Après cette opération, 334 Mo d'espace disque supplémentaires seront utilisés.
Réception de:1 http://fr.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ebtables amd64 2.0.10.4-3.4ubuntu2 [79,4 kB]
Réception de:2 http://fr.archive.ubuntu.com/ubuntu xenial/universe amd64 socat amd64 1.7.3.1-1 [321 kB]
Réception de:3 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubernetes-cni amd64 0.5.1-00 [5 560 kB]
Réception de:4 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubelet amd64 1.7.4-00 [19,5 MB]
Réception de:5 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubectl amd64 1.7.4-00 [10,1 MB]
Réception de:6 https://apt.kubernetes.io kubernetes-xenial/main amd64 kubeadm amd64 1.7.4-00 [9 791 kB]
debconf: Impossible d'initialiser l'interface : Dialog
debconf: (La variable TERM n'a pas de valeur, l'interface dialog est donc inutilisable.)
debconf: Utilisation de l'interface Readline en remplacement
debconf: Impossible d'initialiser l'interface : Readline
debconf: (Cette interface a besoin d'un terminal de contrôle.)
debconf: Utilisation de l'interface Teletype en remplacement
dpkg-preconfigure: impossible de réouvrir stdin : 
45,4 Mo réceptionnés en 18s (2 513 ko/s)
Sélection du paquet ebtables précédemment désélectionné.
(Lecture de la base de données... (Lecture de la base de données... 5%(Lecture de la base de données... 10%(Lecture de la base de données... 15%(Lecture de la base de données... 20%(Lecture de la base de données... 25%(Lecture de la base de données... 30%(Lecture de la base de données... 35%(Lecture de la base de données... 40%(Lecture de la base de données... 45%(Lecture de la base de données... 50%(Lecture de la base de données... 55%(Lecture de la base de données... 60%(Lecture de la base de données... 65%(Lecture de la base de données... 70%(Lecture de la base de données... 75%(Lecture de la base de données... 80%(Lecture de la base de données... 85%(Lecture de la base de données... 90%(Lecture de la base de données... 95%(Lecture de la base de données... 100%(Lecture de la base de données... 103163 fichiers et répertoires déjà installés.)
Préparation du dépaquetage de .../ebtables_2.0.10.4-3.4ubuntu2_amd64.deb ...
Dépaquetage de ebtables (2.0.10.4-3.4ubuntu2) ...
Sélection du paquet kubernetes-cni précédemment désélectionné.
Préparation du dépaquetage de .../kubernetes-cni_0.5.1-00_amd64.deb ...
Dépaquetage de kubernetes-cni (0.5.1-00) ...
Sélection du paquet socat précédemment désélectionné.
Préparation du dépaquetage de .../socat_1.7.3.1-1_amd64.deb ...
Dépaquetage de socat (1.7.3.1-1) ...
Sélection du paquet kubelet précédemment désélectionné.
Préparation du dépaquetage de .../kubelet_1.7.4-00_amd64.deb ...
Dépaquetage de kubelet (1.7.4-00) ...
Sélection du paquet kubectl précédemment désélectionné.
Préparation du dépaquetage de .../kubectl_1.7.4-00_amd64.deb ...
Dépaquetage de kubectl (1.7.4-00) ...
