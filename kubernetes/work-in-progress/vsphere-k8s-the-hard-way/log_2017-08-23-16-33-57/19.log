+ source config.sh
++ export KUBERNETES_PUBLIC_ADDRESS=10.0.6.100
++ KUBERNETES_PUBLIC_ADDRESS=10.0.6.100
++ export IP_M1=10.0.6.100
++ IP_M1=10.0.6.100
++ export IP_M2=10.0.6.101
++ IP_M2=10.0.6.101
++ export IP_M3=10.0.6.102
++ IP_M3=10.0.6.102
++ export HOST_M1=ubuntu16-k6-master1.kubernetes
++ HOST_M1=ubuntu16-k6-master1.kubernetes
++ export HOST_M2=ubuntu16-k6-master2.kubernetes
++ HOST_M2=ubuntu16-k6-master2.kubernetes
++ export HOST_M3=ubuntu16-k6-master3.kubernetes
++ HOST_M3=ubuntu16-k6-master3.kubernetes
++ export IP_W1=10.0.6.110
++ IP_W1=10.0.6.110
++ export IP_W2=10.0.6.111
++ IP_W2=10.0.6.111
++ export IP_W3=10.0.6.112
++ IP_W3=10.0.6.112
++ export HOST_W1=ubuntu16-k6-node1.kubernetes
++ HOST_W1=ubuntu16-k6-node1.kubernetes
++ export HOST_W2=ubuntu16-k6-node2.kubernetes
++ HOST_W2=ubuntu16-k6-node2.kubernetes
++ export HOST_W3=ubuntu16-k6-node3.kubernetes
++ HOST_W3=ubuntu16-k6-node3.kubernetes
++ export CLUSTER_SERVICE_IP_RANGE=10.5.0.0/24
++ CLUSTER_SERVICE_IP_RANGE=10.5.0.0/24
++ export CLUSTER_CIDR=10.244.0.0/16
++ CLUSTER_CIDR=10.244.0.0/16
++ export CLUSTER_DNS=10.32.0.1
++ CLUSTER_DNS=10.32.0.1
++ export DOWNLOAD_DEPENDENCIES=true
++ DOWNLOAD_DEPENDENCIES=true
++ export CERT_DIR_PATH=certs
++ CERT_DIR_PATH=certs
++ export TOKEN_DIR_PATH=token
++ TOKEN_DIR_PATH=token
++ export CA_DIR_PATH=ca
++ CA_DIR_PATH=ca
++ export CONFIG_DIR_PATH=configs
++ CONFIG_DIR_PATH=configs
+ ssh root@10.0.6.100 '

    set -x

    echo "Commands executed on bash by $USER@$HOSTNAME"

    for line in $(kubectl get csr | cut -d'\'' '\'' -f1); do
        if [[ $line != '\''NAME'\'' ]]; then
            kubectl certificate approve $line
        fi
    done

    kubectl get nodes
'
Commands executed on bash by root@
+zsh:5> echo 'Commands executed on bash by root@'
+zsh:7> kubectl get csr
+zsh:7> cut '-d ' -f1
+zsh:7> line=NAME
+zsh:8> [[ NAME != NAME ]]
+zsh:7> line=csr-20ntj
+zsh:8> [[ csr-20ntj != NAME ]]
+zsh:9> kubectl certificate approve csr-20ntj
certificatesigningrequest "csr-20ntj" approved
+zsh:7> line=csr-kj97l
+zsh:8> [[ csr-kj97l != NAME ]]
+zsh:9> kubectl certificate approve csr-kj97l
certificatesigningrequest "csr-kj97l" approved
+zsh:7> line=csr-wdg1w
+zsh:8> [[ csr-wdg1w != NAME ]]
+zsh:9> kubectl certificate approve csr-wdg1w
certificatesigningrequest "csr-wdg1w" approved
+zsh:13> kubectl get nodes
NAME                           STATUS     AGE       VERSION
ubuntu16-k6-node1.kubernetes   NotReady   0s        v1.6.1
ubuntu16-k6-node3.kubernetes   NotReady   0s        v1.6.1
